<!DOCTYPE html>
<html lang='en_US'>
  <head>
    <title>GPIO - Stelfox Athen&#xe6;um</title>

    <meta http-equiv='content-type' content='text/html; charset=utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1' />
    
    

    <link rel="alternate" type="application/atom+xml" title="Stelfox Athen&#xe6;um Feed" href="/atom.xml" />
    <link rel="canonical" href="https://stelfox.net" />
    <link rel="author" href="https://plus.google.com/+SamStelfox31337/"/>

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="GPIO" />
    <meta property="og:url" content="https://stelfox.net/knowledge_base/linux/gpio/" />
    <meta property="og:site_name" content="Stelfox Athen&#xe6;um" />
    <meta property="article:publisher" content="https://www.facebook.com/sstelfox" />
    <meta property="og:image" content="https://stelfox.net/static/avatar-01.jpg" />

    <link rel='stylesheet' href="//fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Alegreya+SC:700" />
    <link rel="stylesheet" href="https://stelfox.net/css/3HrCRVwL3Gos2V4HzXAw/Om/nxs=.css" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-32188490-1', 'stelfox.net');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header class='masthead'>
      <div class='masthead-inner'>
        <h1><a href='/' title='Home'>Sam Stelfox</a></h1>
        <p class='lead'>Thoughts from a systems hacker and developer.</p>
        <nav>
          <ul>
            <li><a href="/about/" title="About">About</a></li>
            <li><a href="/blog/" title="Blog">Blog</a></li>
            <li><a href="/knowledge_base/" title="Knowledge Base">Knowledge Base</a></li>
            <li><form action="/search/" method="get"><input type="search" name="q" placeholder="Search" /></form></li>
          </ul>
        </nav>
        <footer class='colophon'>
          <p>&copy; 2014, All rights reserved.</p>
        </footer>
      </div>
    </header>
    <div class='content container'>
      <h1>GPIO</h1>

<p>I came across this python script that accesses GPIO pins in linux. It&#39;s
potentially very useful so I&#39;m including it here, in it&#39;s entirety. I can later
on reference this for use in my own programs.</p>
<div class="CodeRay">
  <div class="code"><pre>&quot;&quot;&quot;Arduino-like library for Python on BeagleBone&quot;&quot;&quot;
import time

HIGH = &quot;HIGH&quot;
LOW = &quot;LOW&quot;
OUTPUT = &quot;OUTPUT&quot;
INPUT = &quot;INPUT&quot;
pinList = [] # needed for unexport()
startTime = time.time() # needed for millis()
digitalPinDef = {
  &quot;P8.3&quot;:   38,
  &quot;P8.4&quot;:   39,
  &quot;P8.5&quot;:   34,
  &quot;P8.6&quot;:   35,
  &quot;P8.11&quot;:  45,
  &quot;P8.12&quot;:  44,
  &quot;P8.14&quot;:  26,
  &quot;P8.15&quot;:  47,
  &quot;P8.16&quot;:  46,
  &quot;P8.17&quot;:  27,
  &quot;P8.18&quot;:  65,
  &quot;P8.20&quot;:  63,
  &quot;P8.21&quot;:  62,
  &quot;P8.22&quot;:  37,
  &quot;P8.23&quot;:  36,
  &quot;P8.24&quot;:  33,
  &quot;P8.25&quot;:  32,
  &quot;P8.26&quot;:  61,
  &quot;P8.27&quot;:  86,
  &quot;P8.28&quot;:  88,
  &quot;P8.29&quot;:  87,
  &quot;P8.30&quot;:  89,
  &quot;P8.39&quot;:  76,
  &quot;P8.40&quot;:  77,
  &quot;P8.41&quot;:  74,
  &quot;P8.42&quot;:  75,
  &quot;P8.43&quot;:  72,
  &quot;P8.44&quot;:  73,
  &quot;P8.45&quot;:  70,
  &quot;P8.46&quot;:  71,
  &quot;P9.12&quot;:  60,
  &quot;P9.15&quot;:  48,
  &quot;P9.23&quot;:  49,
  &quot;P9.25&quot;:  117,
  &quot;P9.27&quot;:  115,
  &quot;P9.42&quot;:  7
}

analogPinDef = {
  &quot;P9.33&quot;:  &quot;ain4&quot;,
  &quot;P9.35&quot;:  &quot;ain6&quot;,
  &quot;P9.36&quot;:  &quot;ain5&quot;,
  &quot;P9.37&quot;:  &quot;ain2&quot;,
  &quot;P9.38&quot;:  &quot;ain3&quot;,
  &quot;P9.39&quot;:  &quot;ain0&quot;,
  &quot;P9.40&quot;:  &quot;ain1&quot;
}

def pinMode(pin, direction):
  &quot;&quot;&quot;pinMode(pin, direction) opens (exports)  a pin for use and 
  sets the direction&quot;&quot;&quot;
  if pin in digitalPinDef:
    fw = file(&quot;/sys/class/gpio/export&quot;, &quot;w&quot;)
    fw.write(&quot;%d&quot; % (digitalPinDef[pin]))
    fw.close()
    fileName = &quot;/sys/class/gpio/gpio%d/direction&quot; % (digitalPinDef[pin])
    fw = file(fileName, &quot;w&quot;)
    if direction == INPUT:
      fw.write(&quot;in&quot;)
    else:
      fw.write(&quot;out&quot;)
    fw.close()
    pinList.append(digitalPinDef[pin])
  else:
    print &quot;pinMode error: Pin &quot; + pin + &quot; is not defined as a digital I/O pin in the pin definition.&quot;


def digitalWrite(pin, status):
  &quot;&quot;&quot;digitalWrite(pin, status) sets a pin HIGH or LOW&quot;&quot;&quot;
  if pin in digitalPinDef:
    fileName = &quot;/sys/class/gpio/gpio%d/value&quot; % (digitalPinDef[pin])
    fw = file(fileName, &quot;w&quot;)
    if status == HIGH:
      fw.write(&quot;1&quot;)
    if status == LOW:
      fw.write(&quot;0&quot;)
    fw.close()
  else:
    print &quot;digitalWrite error: Pin &quot; + pin + &quot; is not defined as a digital I/O pin in the pin definition.&quot;

def digitalRead(pin):
  &quot;&quot;&quot;digitalRead(pin) returns HIGH or LOW for a given pin.&quot;&quot;&quot;
  if pin in digitalPinDef:
    fileName = &quot;/sys/class/gpio/gpio%d/value&quot; % (digitalPinDef[pin])
    fw = file(fileName, &quot;r&quot;)
    inData = fw.read()
    fw.close()
    if inData == &quot;0\n&quot;:
      return LOW
    if inData == &quot;1\n&quot;:
      return HIGH
  else:
    print &quot;digitalRead error: Pin &quot; + pin + &quot; is not defined as a digital I/O pin in the pin definition.&quot;
    return -1;

def analogRead(pin):
  &quot;&quot;&quot;analogRead(pin) returns analog value for a given pin.&quot;&quot;&quot;
  if pin in analogPinDef:
    fileName = &quot;/sys/devices/platform/tsc/&quot; + (analogPinDef[pin])
    fw = file(fileName, &quot;r&quot;)
    return fw.read()
  fw.close()
else:
  print &quot;analogRead error: Pin &quot; + pin + &quot; is not defined as an analog in pin in the pin definition.&quot;
    return -1;

def pinUnexport(pin):
  &quot;&quot;&quot;pinUnexport(pin) closes a pin in sysfs. This is susally 
  called by cleanup() when a script is exiting.&quot;&quot;&quot;
  fw = file(&quot;/sys/class/gpio/unexport&quot;, &quot;w&quot;)
  fw.write(&quot;%d&quot; % (pin))
  fw.close()

def cleanup():
  &quot;&quot;&quot; takes care of stepping through pins that were set with
  pinMode and unExports them. Prints result&quot;&quot;&quot;
  def find_key(dic, val):
    return [k for k, v in dic.iteritems() if v == val][0]
  print &quot;&quot;
  print &quot;Cleaning up. Unexporting the following pins:&quot;,
  for pin in pinList:
    pinUnexport(pin)
    print find_key(digitalPinDef, pin),

def delay(millis):
  &quot;&quot;&quot;delay(millis) sleeps the script for a given number of 
  milliseconds&quot;&quot;&quot;
  time.sleep(millis/1000.0)

def millis():
  &quot;&quot;&quot;millis() returns an int for the number of milliseconds since 
  the script started.&quot;&quot;&quot;
  return int((time.time() - startTime) * 1000)

def run(setup, main): # from PyBBIO by Alexander Hiam - ahiam@marlboro.edu - www.alexanderhiam.com https://github.com/alexanderhiam/PyBBIO
  &quot;&quot;&quot; The main loop; must be passed a setup and a main function.
  First the setup function will be called once, then the main
  function wil be continuously until a stop signal is raised, 
  e.g. CTRL-C or a call to the stop() function from within the
  main function. &quot;&quot;&quot;
  try:
    setup()
    while (True):
      main()
  except KeyboardInterrupt:
    # Manual exit signal, clean up and exit happy
    cleanup()
  except Exception, e:
    # Something may have gone wrong, clean up and print exception
    cleanup()
    print e
</pre></div>
</div>

    </div>
  </body>
</html>
